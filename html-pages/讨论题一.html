<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="刘晓亮">

<title>讨论题一</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="讨论题一_files/libs/clipboard/clipboard.min.js"></script>
<script src="讨论题一_files/libs/quarto-html/quarto.js"></script>
<script src="讨论题一_files/libs/quarto-html/popper.min.js"></script>
<script src="讨论题一_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="讨论题一_files/libs/quarto-html/anchor.min.js"></script>
<link href="讨论题一_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="讨论题一_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="讨论题一_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="讨论题一_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="讨论题一_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">讨论题一</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>刘晓亮 </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="讨论题一" class="level1">
<h1>讨论题一</h1>
<ul>
<li>2025-3-17</li>
</ul>
<p><img src="images/clipboard-3905462667.png" class="img-fluid"></p>
<section id="第一小问" class="level2">
<h2 class="anchored" data-anchor-id="第一小问">第一小问</h2>
<p>这六门课程可以使用两个因子进行降维，具体解释及求解见下文</p>
<p>1、从理论上来说，这些科可以进行文理分类，具有理论和逻辑基础，应当可以分为两个因子；</p>
<p>2、从数据分析角度，我们使用因子分析法看一看结果如何，如下：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用ai输入矩阵</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>subjects_cor <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.0</span>, <span class="fl">0.439</span>, <span class="fl">0.410</span>, <span class="fl">0.288</span>, <span class="fl">0.329</span>, <span class="fl">0.248</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.439</span>, <span class="fl">1.0</span>, <span class="fl">0.351</span>, <span class="fl">0.354</span>, <span class="fl">0.320</span>, <span class="fl">0.329</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.410</span>, <span class="fl">0.351</span>, <span class="fl">1.0</span>, <span class="fl">0.164</span>, <span class="fl">0.190</span>, <span class="fl">0.181</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.288</span>, <span class="fl">0.354</span>, <span class="fl">0.164</span>, <span class="fl">1.0</span>, <span class="fl">0.595</span>, <span class="fl">0.470</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.329</span>, <span class="fl">0.320</span>, <span class="fl">0.190</span>, <span class="fl">0.595</span>, <span class="fl">1.0</span>, <span class="fl">0.464</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.248</span>, <span class="fl">0.329</span>, <span class="fl">0.181</span>, <span class="fl">0.470</span>, <span class="fl">0.464</span>, <span class="fl">1.0</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>subjects_cor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]
[1,] 1.000 0.439 0.410 0.288 0.329 0.248
[2,] 0.439 1.000 0.351 0.354 0.320 0.329
[3,] 0.410 0.351 1.000 0.164 0.190 0.181
[4,] 0.288 0.354 0.164 1.000 0.595 0.470
[5,] 0.329 0.320 0.190 0.595 1.000 0.464
[6,] 0.248 0.329 0.181 0.470 0.464 1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(subjects_cor,<span class="at">n=</span><span class="dv">220</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 310.8409

$p.value
[1] 3.110695e-57

$df
[1] 15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 因子分析</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fa1 <span class="ot">&lt;-</span> <span class="fu">factanal</span>(<span class="at">factors =</span> <span class="dv">2</span>, <span class="at">covmat =</span> subjects_cor,<span class="at">rotation=</span><span class="st">"none"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
factanal(factors = 2, covmat = subjects_cor, rotation = "none")

Uniquenesses:
[1] 0.510 0.594 0.644 0.377 0.431 0.628

Loadings:
     Factor1 Factor2
[1,]  0.553   0.429 
[2,]  0.568   0.288 
[3,]  0.392   0.450 
[4,]  0.740  -0.273 
[5,]  0.724  -0.211 
[6,]  0.595  -0.132 

               Factor1 Factor2
SS loadings      2.209   0.606
Proportion Var   0.368   0.101
Cumulative Var   0.368   0.469

The degrees of freedom for the model is 4 and the fit was 0.0109 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fa2 <span class="ot">&lt;-</span> <span class="fu">factanal</span>(<span class="at">factors =</span> <span class="dv">3</span>, <span class="at">covmat =</span> subjects_cor,<span class="at">rotation=</span><span class="st">"varimax"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
factanal(factors = 3, covmat = subjects_cor, rotation = "varimax")

Uniquenesses:
[1] 0.450 0.498 0.679 0.412 0.358 0.613

Loadings:
     Factor1 Factor2 Factor3
[1,]  0.225   0.707         
[2,]  0.296   0.540   0.350 
[3,]          0.554         
[4,]  0.738   0.173   0.116 
[5,]  0.767   0.220         
[6,]  0.566   0.186   0.179 

               Factor1 Factor2 Factor3
SS loadings      1.600   1.210   0.179
Proportion Var   0.267   0.202   0.030
Cumulative Var   0.267   0.468   0.498

The degrees of freedom for the model is 0 and the fit was 9e-04 </code></pre>
</div>
</div>
<p>可解释方差比例有点小啊，不到一半，但是确实可以分为两个因子，就载荷阵来看，三个因子能解释的，两个也能解释。故，我认为第一问可以使用两个因子降维，一个作为综合，一个作为对比。</p>
</section>
<section id="第二小问" class="level2">
<h2 class="anchored" data-anchor-id="第二小问">第二小问</h2>
<section id="用princomp做的结果与principal做的结果之间存在怎样的对应关系" class="level4">
<h4 class="anchored" data-anchor-id="用princomp做的结果与principal做的结果之间存在怎样的对应关系"><strong>用princomp做的结果与principal做的结果之间存在怎样的对应关系？</strong></h4>
<p>首先什么是<strong>princomp与principal?<br>
在R语言中：</strong></p>
<p><a href="https://zhuanlan.zhihu.com/p/496823203" class="uri">https://zhuanlan.zhihu.com/p/496823203</a>R语言 | 主成分分析：princomp vs.&nbsp;prcomp vs.&nbsp;principal - 知乎 (zhihu.com)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  princomp</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>princomp_1 <span class="ot">&lt;-</span> <span class="fu">princomp</span>(<span class="at">covmat=</span>subjects_cor, <span class="at">cor =</span> T)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 注意这个参数的用法</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(princomp_1,<span class="at">loadings=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2    Comp.3    Comp.4     Comp.5
Standard deviation     1.6531437 1.0629066 0.7843302 0.7753850 0.72442868
Proportion of Variance 0.4554807 0.1882951 0.1025290 0.1002036 0.08746615
Cumulative Proportion  0.4554807 0.6437757 0.7463047 0.8465084 0.93397452
                           Comp.6
Standard deviation     0.62940679
Proportion of Variance 0.06602548
Cumulative Proportion  1.00000000

Loadings:
     Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6
[1,]  0.398  0.422  0.238  0.447  0.621  0.147
[2,]  0.416  0.273  0.650 -0.406 -0.370 -0.168
[3,]  0.313  0.600 -0.671        -0.286       
[4,]  0.447 -0.389         0.232 -0.352  0.687
[5,]  0.450 -0.353 -0.136  0.402 -0.122 -0.691
[6,]  0.410 -0.334 -0.228 -0.640  0.508       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># principal</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>principal_1 <span class="ot">&lt;-</span> <span class="fu">principal</span>(subjects_cor,<span class="at">nfactors=</span><span class="dv">2</span>,<span class="at">rotate=</span><span class="st">"none"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>principal_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = subjects_cor, nfactors = 2, rotate = "none")
Standardized loadings (pattern matrix) based upon correlation matrix
   PC1   PC2   h2   u2 com
1 0.66  0.45 0.63 0.37 1.8
2 0.69  0.29 0.56 0.44 1.3
3 0.52  0.64 0.67 0.33 1.9
4 0.74 -0.41 0.72 0.28 1.6
5 0.74 -0.38 0.69 0.31 1.5
6 0.68 -0.36 0.59 0.41 1.5

                       PC1  PC2
SS loadings           2.73 1.13
Proportion Var        0.46 0.19
Cumulative Var        0.46 0.64
Proportion Explained  0.71 0.29
Cumulative Proportion 0.71 1.00

Mean item complexity =  1.6
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.11 

Fit based upon off diagonal values = 0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"-----------------------------------------------------------"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "-----------------------------------------------------------"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>principal_2 <span class="ot">&lt;-</span> <span class="fu">principal</span>(subjects_cor,<span class="at">nfactors=</span><span class="dv">2</span>,<span class="at">rotate=</span><span class="st">"varimax"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>principal_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = subjects_cor, nfactors = 2, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
   RC1  RC2   h2   u2 com
1 0.22 0.76 0.63 0.37 1.2
2 0.35 0.66 0.56 0.44 1.5
3 0.00 0.82 0.67 0.33 1.0
4 0.83 0.15 0.72 0.28 1.1
5 0.81 0.18 0.69 0.31 1.1
6 0.75 0.16 0.59 0.41 1.1

                       RC1  RC2
SS loadings           2.09 1.78
Proportion Var        0.35 0.30
Cumulative Var        0.35 0.64
Proportion Explained  0.54 0.46
Cumulative Proportion 0.54 1.00

Mean item complexity =  1.2
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.11 

Fit based upon off diagonal values = 0.9</code></pre>
</div>
</div>
<p>就上述代码结果而言，好像看不出什么关系,该关系是不是需要先从理论层面推导，再以代码验证？</p>
<p>借鉴一下：<br>
princomp()函数得出来的结果（Comp.1…），与我们求解<a href="https://zhida.zhihu.com/search?content_id=92540452&amp;content_type=Answer&amp;match_order=1&amp;q=%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0%E7%9F%A9%E9%98%B5&amp;zhida_source=entity">相关系数矩阵</a>得出的特征向量和特征值是一致的，这个特征向量代表的是主成分（PC1…）与各变量(X1…)的回归系数；而principal()函数得出的结果，是主成分(PC1…）与各变量(X1…)的相关系数，所以不一样，因为中间有一个变换：相关系数的求解公式如下：corr(PC1,X1)=a11*[Var(PC1)]^(0.5) ,其中Var(PC1)就是主成分PC1的特征值。也就是说：principal()函数得出的结果，可以用来更好的解释主成分与原变量之间的相关性。<br>
作者：liar lee<br>
链接：https://www.zhihu.com/question/52027293/answer/343635079<br>
</p>
<p><span class="math display">\[
Cor(PC1,X1
)=a11*[Var(PC1)]^{0.5}\]</span></p>
<p>这个公式见过，学综合评价的时候似乎用过它，或者是类似的，这应当就是他们之间的关系了。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 求其特征值与特征向量</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(subjects_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 2.7328841 1.1297704 0.6151739 0.6012219 0.5247969 0.3961529

$vectors
           [,1]       [,2]          [,3]        [,4]       [,5]        [,6]
[1,] -0.3979211 -0.4224739  0.2378797843  0.44697886 -0.6205763  0.14725080
[2,] -0.4164293 -0.2732052  0.6497850613 -0.40590321  0.3699525 -0.16763850
[3,] -0.3129591 -0.5996225 -0.6713466822 -0.09898664  0.2855052  0.02217036
[4,] -0.4466126  0.3885864 -0.0008312812  0.23224145  0.3517809  0.68691430
[5,] -0.4499766  0.3532281 -0.1360853358  0.40242630  0.1217941 -0.69097829
[6,] -0.4103173  0.3340032 -0.2279611918 -0.64013367 -0.5078616  0.02051222</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3979211</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fl">2.7328841</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6578208</code></pre>
</div>
</div>
</section>
</section>
<section id="总结" class="level2">
<h2 class="anchored" data-anchor-id="总结">总结</h2>
<p>(1)、</p>
<p>这六门课程可以使用两个因子进行降维，具体解释及求解见下文</p>
<p>1、从理论上来说，这些科可以进行文理分类，具有理论和逻辑基础，应当可以分为两个因子；</p>
<p>2、从数据分析角度，我们使用因子分析法看一下结果如何</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fa2 <span class="ot">&lt;-</span> <span class="fu">factanal</span>(<span class="at">factors =</span> <span class="dv">2</span>, <span class="at">covmat =</span> subjects_cor,<span class="at">rotation=</span><span class="st">"varimax"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
factanal(factors = 2, covmat = subjects_cor, rotation = "varimax")

Uniquenesses:
[1] 0.510 0.594 0.644 0.377 0.431 0.628

Loadings:
     Factor1 Factor2
[1,] 0.235   0.659  
[2,] 0.323   0.549  
[3,]         0.590  
[4,] 0.771   0.170  
[5,] 0.724   0.213  
[6,] 0.572   0.210  

               Factor1 Factor2
SS loadings      1.612   1.203
Proportion Var   0.269   0.201
Cumulative Var   0.269   0.469

The degrees of freedom for the model is 4 and the fit was 0.0109 </code></pre>
</div>
</div>
<p>（2）、</p>
<p><span class="math display">\[
Fa\_(PC11)=comp_{11}*[PC\_PC1)]^{0.5}\\
\]</span></p>
<p><span class="math display">\[
Corr(PC1,X1)=a11*[Var(PC1)]^{0.5}\\
\]</span></p>
<p><span class="math display">\[
0.6578208=0.3979211*sqrt(2.7328841)\\
\]</span></p>
<p>该公式似乎便是相关关系具体解释如下:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>princomp_1 <span class="ot">&lt;-</span> <span class="fu">princomp</span>(<span class="at">covmat=</span>subjects_cor, <span class="at">cor =</span> T)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 注意这个参数的用法</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(princomp_1,<span class="at">loadings=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2    Comp.3    Comp.4     Comp.5
Standard deviation     1.6531437 1.0629066 0.7843302 0.7753850 0.72442868
Proportion of Variance 0.4554807 0.1882951 0.1025290 0.1002036 0.08746615
Cumulative Proportion  0.4554807 0.6437757 0.7463047 0.8465084 0.93397452
                           Comp.6
Standard deviation     0.62940679
Proportion of Variance 0.06602548
Cumulative Proportion  1.00000000

Loadings:
     Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6
[1,]  0.398  0.422  0.238  0.447  0.621  0.147
[2,]  0.416  0.273  0.650 -0.406 -0.370 -0.168
[3,]  0.313  0.600 -0.671        -0.286       
[4,]  0.447 -0.389         0.232 -0.352  0.687
[5,]  0.450 -0.353 -0.136  0.402 -0.122 -0.691
[6,]  0.410 -0.334 -0.228 -0.640  0.508       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>principal_1 <span class="ot">&lt;-</span> <span class="fu">principal</span>(subjects_cor,<span class="at">nfactors=</span><span class="dv">2</span>,<span class="at">rotate=</span><span class="st">"none"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>principal_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = subjects_cor, nfactors = 2, rotate = "none")
Standardized loadings (pattern matrix) based upon correlation matrix
   PC1   PC2   h2   u2 com
1 0.66  0.45 0.63 0.37 1.8
2 0.69  0.29 0.56 0.44 1.3
3 0.52  0.64 0.67 0.33 1.9
4 0.74 -0.41 0.72 0.28 1.6
5 0.74 -0.38 0.69 0.31 1.5
6 0.68 -0.36 0.59 0.41 1.5

                       PC1  PC2
SS loadings           2.73 1.13
Proportion Var        0.46 0.19
Cumulative Var        0.46 0.64
Proportion Explained  0.71 0.29
Cumulative Proportion 0.71 1.00

Mean item complexity =  1.6
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.11 

Fit based upon off diagonal values = 0.9</code></pre>
</div>
</div>
<p><img src="images/clipboard-2648882682.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 求其特征值与特征向量</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(subjects_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 2.7328841 1.1297704 0.6151739 0.6012219 0.5247969 0.3961529

$vectors
           [,1]       [,2]          [,3]        [,4]       [,5]        [,6]
[1,] -0.3979211 -0.4224739  0.2378797843  0.44697886 -0.6205763  0.14725080
[2,] -0.4164293 -0.2732052  0.6497850613 -0.40590321  0.3699525 -0.16763850
[3,] -0.3129591 -0.5996225 -0.6713466822 -0.09898664  0.2855052  0.02217036
[4,] -0.4466126  0.3885864 -0.0008312812  0.23224145  0.3517809  0.68691430
[5,] -0.4499766  0.3532281 -0.1360853358  0.40242630  0.1217941 -0.69097829
[6,] -0.4103173  0.3340032 -0.2279611918 -0.64013367 -0.5078616  0.02051222</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3979211</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fl">2.7328841</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6578208</code></pre>
</div>
</div>
<p>参考：链接：https://www.zhihu.com/question/52027293/answer/343635079</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>