<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="多元统计笔记及习题" />
    <meta name="hexo-theme-A4" content="v1.9.7" />
    <link rel="alternate icon" type="image/webp" href="/img/myhead.png">
    <title>刘晓亮 | 知其白，守其黑，为天下式</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--注意：首页既不是post也不是page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--返回顶部css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--目录-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>
    
    
        <style>
            .index-main{
                max-width:  880px;
            }
        </style>

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        <script>
            const options = {
                bottom: '40px', // default: '32px'
                right: 'unset', // default: '32px'
                left: '42px', // default: 'unset'
                time: '0.3s', // default: '0.3s'
                mixColor: '#fff', // default: '#fff'
                backgroundColor: ' #e4e4e4 ',  // default: '#fff'
                buttonColorDark: '#100f2c',  // default: '#100f2c'
                buttonColorLight: '#fff', // default: '#fff'
                saveInCookies: true, // default: true,
                label: '🌓', // default: ''
                autoMatchOsTheme: true // default: true
            }
            const darkmode = new Darkmode(options);
            darkmode.showWidget();
        </script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <style>
            .header-img {
                width: 56px;
                height: auto;
                object-fit: cover; /* 保持图片比例 */
                transition: transform 0.3s ease-in-out; 
                border-radius: 0; 
            }
            
        </style>
        <img 
            alt="^-^" 
            cache-control="max-age=86400" 
            class="header-img" 
            src="/img/myhead.png" 
        />
        <div class="header-content">
            <a class="logo" href="/">刘晓亮</a> 
            <span class="description">技术笔记，学习记录，生活琐事，随笔感悟。</span> 
        </div>
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">首页</a></li>
            
        
            
                <li><a href="/list/">文章</a></li>
            
        
            
                <li><a href="/about/">关于</a></li>
            
        
            
                <li><a href="/tags/">标签</a></li>
            
        
            
                <li><a href="/categories/">分类</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--说明是文章post页面-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    多元统计笔记及习题
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                    <span>最近更新：2025-03-12</span> 
                
                
                    
                        &nbsp; | &nbsp;
                    
                     <span>字数总计：2.6k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>阅读估时：11分钟</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                        阅读量：<span id="busuanzi_value_page_pv"></span>次
                    </span>
                
            </div>
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#2025-2-21"><span class="post-toc-text">2025-2-21</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%80%E3%80%81%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5"><span class="post-toc-text">一、重要概念</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BA%8C%E3%80%81%E6%80%9D%E8%80%83%E9%A2%98"><span class="post-toc-text">二、思考题</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%89%E3%80%81%E4%BB%A3%E7%A0%81%E9%A2%98"><span class="post-toc-text">三、代码题</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#2025-3-3"><span class="post-toc-text">2025-3-3</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%80%E3%80%81%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5-1"><span class="post-toc-text">一、重要概念</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BA%8C%E3%80%81%E6%80%9D%E8%80%83%E9%A2%98-1"><span class="post-toc-text">二、思考题</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%89%E3%80%81%E4%BB%A3%E7%A0%81%E6%91%98%E5%BD%95"><span class="post-toc-text">三、代码摘录</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#2025-3-6"><span class="post-toc-text">2025-3-6</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5"><span class="post-toc-text">重要概念</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%80%9D%E8%80%83%E9%A2%98"><span class="post-toc-text">思考题</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BB%A3%E7%A0%81%E6%91%98%E5%BD%95"><span class="post-toc-text">代码摘录</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#2025-3-9"><span class="post-toc-text">2025-3-9</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%80%E3%80%81%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5-2"><span class="post-toc-text">一、重要概念</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90"><span class="post-toc-text">主成分分析</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BA%8C%E3%80%81%E6%80%9D%E8%80%83%E9%A2%98-2"><span class="post-toc-text">二、思考题</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%8E%A8%E5%AF%BC%E8%BF%87%E7%A8%8B"><span class="post-toc-text">推导过程</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%89%E3%80%81%E4%BB%A3%E7%A0%81%E6%91%98%E5%BD%95-1"><span class="post-toc-text">三、代码摘录</span></a></li></ol></li></ol>
            
        
        <div class=".article-gallery"><h1 id="2025-2-21"><a href="#2025-2-21" class="headerlink" title="2025-2-21"></a>2025-2-21</h1><h2 id="一、重要概念"><a href="#一、重要概念" class="headerlink" title="一、重要概念"></a>一、重要概念</h2><ul>
<li>association 表示变量之间的所有关系，包括线性和非线性。</li>
<li>correlation 专指线性相关。</li>
<li>样本方差是总体方差的无偏估计，但标准差不是（开根号后就不是了）；样本均值也是总体均值的无偏估计。</li>
<li>中位数 median 相较于均值 mean 来说，比较稳健（对于奇异值）；奇异值：在这里暂指极大极小值。</li>
<li>箱型图中通过箱体长度观察方差的大小。</li>
<li>多元统计的目标是：降维。在不损失较多数据信息的情况下，多数据降维。</li>
<li>多元数据分析分两类：探索性数据分析和验证性数据分析；探索性（图表法，描述统计量）；验证性（假设模型，假设分布）。</li>
<li>实对称矩阵非负定，对应的二次型非负。</li>
<li>相关系数 <em>R</em>：消除量纲，有意义，有界。</li>
<li>在正态情况下，不相关与独立完全等价，但其他情况下不行。</li>
<li>只有协方差阵可以决定数据是否可以降维。</li>
<li>R 语言中矩阵乘积（内积）：%*%。</li>
<li>随机向量 <em>X</em>&#x3D;(<em>X</em>1,<em>X</em>2,…,<em>X**p</em>) 的协方差阵 <em>D</em>(<em>X</em>)&#x3D;Σ 是对称非负定矩阵。</li>
<li>幂等矩阵：<em>AA</em>&#x3D;<em>A</em>；正交阵：<em>A<strong>T</strong>A</em>&#x3D;<em>A<strong>A</strong>T</em>&#x3D;<em>I**n</em>。</li>
<li>由 <em>n</em> 维向量组成的向量组，其秩小于等于 <em>n</em>。</li>
<li>对应于不同特征值的特征向量必线性无关。</li>
</ul>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.kevinchu.top/2023/09/12/hexo-supports-latex/#1-%E5%89%8D%E8%A8%80">Hexo支持LaTeX数学公式渲染</a>，解决 Hexo 数学公式渲染问题。</p>
<ul>
<li><p>随机向量$X &#x3D; (X_1，X_2，…,X_p)的协方差阵D(X)&#x3D;\Sigma$是对称非负定矩阵</p>
</li>
<li><p>幂等矩阵：AA&#x3D;A;正交阵：$A^TA&#x3D;AA^T&#x3D;I_n$</p>
</li>
<li><p>随机向量$X &#x3D; (X_1，X_2，…,X_p)的协方差阵D(X)&#x3D;\Sigma$是对称非负定矩阵</p>
</li>
<li><p>幂等矩阵：AA&#x3D;A;正交阵：$A^TA&#x3D;AA^T&#x3D;I_n$</p>
</li>
</ul>
<h2 id="二、思考题"><a href="#二、思考题" class="headerlink" title="二、思考题"></a>二、思考题</h2><p>1、$\Sigma$推导（随机向量$X &#x3D; (X_1，X_2，…,X_p)的协方差阵D(X)&#x3D;\Sigma$）是对称非负定矩阵，使用矩阵代数相关知识<br>$$<br>解：Cov(X_i,X_i)&#x3D;Cov(X_j,X_i),即\Sigma&#x3D;\Sigma^T。满足矩阵对称性\<br>$$</p>
<p>展开后，协方差矩阵的元素可以表示为<br>$$<br>\Sigma_{ij} &#x3D; \text{Cov}(X_i, X_j) &#x3D; \mathbb{E}[(X_i - \mu_i)(X_j - \mu_j)] \<br>$$<br>具体形式如下：</p>
<span>
$$
\Sigma = \begin{bmatrix}
\text{Var}(X_1) & \text{Cov}(X_1, X_2) & \cdots & \text{Cov}(X_1, X_n) \\
\text{Cov}(X_2, X_1) & \text{Var}(X_2) & \cdots & \text{Cov}(X_2, X_n) \\
\vdots & \vdots & \ddots & \vdots \\
\text{Cov}(X_n, X_1) & \text{Cov}(X_n, X_2) & \cdots & \text{Var}(X_n)
\end{bmatrix}\\
\\
$$
</span>

<span>
$$
cov(X,Y)=E(X-E(X)(Y-E(Y)))\\
$$
</span>

<span>
$$
\Sigma = \begin{bmatrix}
\text E(X_1-E(X)(X_1-E(X)) & \text...& \cdots & \text... \\
\text E(X_2-E(X)(X_1-E(X)) & \text... & \cdots & \text...\\
\vdots & \vdots & \ddots & \vdots \\
\text E(X_n-E(X)(X_1-E(X)) & \text... & \cdots & \text...
\end{bmatrix}\\
$$
</span>
$$
一个列向量乘以一个行向量，可以得到n\times n的矩阵。
$$
<span>
$$
\Sigma = \begin{bmatrix}E(X_1-E(X)) \\
E(X_2-E(X)) \\
\vdots \\
E(X_n-E(X))
\end{bmatrix}
\times
\begin{bmatrix}
E(X_1-E(X)) & E(X_2-E(X)) & \cdots & E(X_n-E(X))
\end{bmatrix}\\
$$

<p>$$<br>&#x3D;E((X-E(X))E(X-E(X))^T)<br>$$</p>
</span>
$$
在二次型中如果矩阵A为p\times p的实对称矩阵时\\
$$

<p>$$<br>对于x属于R^p有,Q(x)&#x3D;x^TAx\<br>$$</p>
<p>$$<br>同理，对于给定的a&#x3D;(a_1,a_2,…,a_p)^T\<br>$$</p>
<p>$$<br>a^T\Sigma a &#x3D; a^TE((X-E(X))E(X-E(X))^T)a\<br>$$</p>
<p>$$<br>&#x3D;E(a^T(X-E(X))(X-E(X))^Ta)\<br>$$</p>
<p>$$<br>&#x3D;E[(a^T(X-E(X)))^2]&gt;&#x3D;0\<br>$$</p>
<p>2、R也是非负定的<br>$$<br>[ r &#x3D; \frac{\sum_{i&#x3D;1}^{n} (X_i - \bar{X})(Y_i - \bar{Y})}{\sqrt{\sum_{i&#x3D;1}^{n} (X_i - \bar{X})^2} \cdot \sqrt{\sum_{i&#x3D;1}^{n} (Y_i - \bar{Y})^2}} ]<br>$$</p>
<p>$$<br>同理，我们在上面证明了Sigma是对称非负定的，显然R是对称的。\<br>$$</p>
<p>$$<br>对于给定的a&#x3D;(a_1,a_2,…,a_p)^T\<br>$$</p>
<p>$$<br>Q(x)&#x3D;a^TRa&#x3D;a^T\frac{\Sigma}{\sqrt{\sigma_X}\sqrt{\sigma y}}a\<br>$$</p>
<p>$$<br>我们显然可以看到对于相关系数来说：R是非负定的。<br>R是由\Sigma变化得来的。<br>$$</p>
<p>3、证明S是非负定的</p>
<p>以下是证明过程：<br>$$<br>S &#x3D; \frac{1}{n-1}\Sigma_{i&#x3D;1}^{n}[(x_i-\bar(x))(x_i-\bar(x))]^T&#x3D;(\hat{\sigma_{lk}})_{p\times p}<br>$$</p>
<p>$$<br>令A&#x3D;（x_i-\bar{x})^T,则S&#x3D;A^TA\times  c<br>$$</p>
<p>$$<br>证明：易见 (A^T A) 和 (AA^T) 都是对称半正定矩阵：(\forall \mathbf{x} \in \mathbb{R}^p)，\<br>$$</p>
<p>$$<br>[ \mathbf{x}^T (A^T A) \mathbf{x} &#x3D; (A \mathbf{x})^T (A \mathbf{x}) &#x3D; |A \mathbf{x}|^2 \geq 0. ]\<br>$$</p>
<p>$$<br>可以证明 (\text{rank}(A) &#x3D; \text{rank}(A^T A) &#x3D; \text{rank}\<br>$$</p>
<p>$$<br>(AA^T))。(A^T A) 和 (AA^T) 仅有非负特征值。\<br>$$</p>
<p>即S为非负定对称阵</p>
<h2 id="三、代码题"><a href="#三、代码题" class="headerlink" title="三、代码题"></a>三、代码题</h2><p>$$<br>协方差矩阵：S &#x3D; \frac{1}{n-1} \sum_{i&#x3D;1}^{n} (x_i - \bar{x})(x_i - \bar{x})^T<br>$$</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、如何自己不通过已有函数计算cov,cor</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 伪代码如下</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 计算cov</span></span><br><span class="line"></span><br><span class="line">mx <span class="operator">&lt;-</span> colMeans<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">cor<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">cov<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">X <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">(</span>E <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span>n<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">S <span class="operator">&lt;-</span> t<span class="punctuation">(</span>AA<span class="operator">-</span>E<span class="operator">%*%</span>t<span class="punctuation">(</span>mx<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">%*%</span><span class="punctuation">(</span>AA<span class="operator">-</span>E<span class="operator">%*%</span>t<span class="punctuation">(</span>mx<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span><span class="number">51</span></span><br><span class="line"></span><br><span class="line">S <span class="operator">==</span> cov<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 计算cor</span></span><br><span class="line"></span><br><span class="line">AA_centered <span class="operator">&lt;-</span> AA <span class="operator">-</span> E <span class="operator">%*%</span> t<span class="punctuation">(</span>mx<span class="punctuation">)</span> <span class="comment"># 中心化处理（减去均值）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算协方差矩阵</span></span><br><span class="line">S <span class="operator">&lt;-</span> t<span class="punctuation">(</span>AA_centered<span class="punctuation">)</span> <span class="operator">%*%</span> AA_centered <span class="operator">/</span> <span class="punctuation">(</span>nrow<span class="punctuation">(</span>AA<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算变量的标准差</span></span><br><span class="line">std_dev <span class="operator">&lt;-</span> <span class="built_in">sqrt</span><span class="punctuation">(</span>diag<span class="punctuation">(</span>S<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算相关系数矩阵</span></span><br><span class="line">cor_matrix <span class="operator">&lt;-</span> S <span class="operator">/</span> <span class="punctuation">(</span>outer<span class="punctuation">(</span>std_dev<span class="punctuation">,</span> std_dev<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印相关系数矩阵</span></span><br><span class="line">print<span class="punctuation">(</span>cor_matrix<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>利用矩阵代数的知识计算主要在于公式</p>
<hr>
<h1 id="2025-3-3"><a href="#2025-3-3" class="headerlink" title="2025-3-3"></a>2025-3-3</h1><h2 id="一、重要概念-1"><a href="#一、重要概念-1" class="headerlink" title="一、重要概念"></a>一、重要概念</h2><p>  - 有监督学习和无监督学习； 无监督学习：将所有变量地位看作一样，没有自变量，应变量之说：主成分，因子，聚类分析 有监督学习：变量之间的地位不一样，有响应变量和潜在预测变量区分，主要是想用预测变量去阐释响应变量的变异：回归模型 - 方差分析是回归的特例 当响应变量是连续性时：线性和非线性 当响应变量非连续：广义线性模型 生存模型：生存分析，我所感兴趣的时间发生的时间 - 有标签：判别分析；无标签：聚类分析</p>
<h2 id="二、思考题-1"><a href="#二、思考题-1" class="headerlink" title="二、思考题"></a>二、思考题</h2><p>1、</p>
<p>2、</p>
<h2 id="三、代码摘录"><a href="#三、代码摘录" class="headerlink" title="三、代码摘录"></a>三、代码摘录</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ----------------------------------------------------</span></span><br><span class="line"><span class="comment">#马氏距离函数</span></span><br><span class="line">mahalanobis_dist <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span>mu<span class="punctuation">,</span>Sigma<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  t<span class="punctuation">(</span>x<span class="operator">-</span>mu<span class="punctuation">)</span><span class="operator">%*%</span>solve<span class="punctuation">(</span>Sigma<span class="punctuation">)</span><span class="operator">%*%</span><span class="punctuation">(</span>x<span class="operator">-</span>mu<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------------------------------------------</span></span><br><span class="line"><span class="comment"># plotly交互式绘图</span></span><br><span class="line">x <span class="operator">&lt;-</span> seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">4</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">,</span>length.out<span class="operator">=</span><span class="number">60</span><span class="punctuation">)</span></span><br><span class="line">y <span class="operator">&lt;-</span> seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">,</span>length.out<span class="operator">=</span><span class="number">60</span><span class="punctuation">)</span></span><br><span class="line">grid <span class="operator">&lt;-</span> expand.grid<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算二维正态分布的密度</span></span><br><span class="line">z <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span>dmvnorm<span class="punctuation">(</span>grid<span class="punctuation">,</span>mean<span class="operator">=</span>mu<span class="punctuation">,</span>sigma <span class="operator">=</span> Sigma<span class="punctuation">)</span><span class="punctuation">,</span>nrow <span class="operator">=</span> <span class="built_in">length</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>plotly<span class="punctuation">)</span></span><br><span class="line">plot_ly<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">,</span>z<span class="operator">=</span>z<span class="punctuation">)</span><span class="operator">|&gt;</span></span><br><span class="line">  add_surface<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">|&gt;</span></span><br><span class="line">  layout<span class="punctuation">(</span></span><br><span class="line">    title <span class="operator">=</span> <span class="string">&quot;2D&quot;</span><span class="punctuation">,</span></span><br><span class="line">    scene <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span></span><br><span class="line">      xaxis <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;X&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      yaxis <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;Y&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      zaxis <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;Z&quot;</span><span class="punctuation">)</span></span><br><span class="line">    <span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------------------------</span></span><br><span class="line"><span class="comment"># 画等高线图函数</span></span><br><span class="line">contour<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">,</span>z<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------------------------</span></span><br><span class="line"><span class="comment"># 注意apply函数的妙用</span></span><br><span class="line">d <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>X<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="keyword">function</span><span class="punctuation">(</span>z<span class="punctuation">)</span> t<span class="punctuation">(</span>z<span class="operator">-</span>mx<span class="punctuation">)</span><span class="operator">%*%</span>solve<span class="punctuation">(</span>S<span class="punctuation">)</span><span class="operator">%*%</span><span class="punctuation">(</span>z<span class="operator">-</span>mx<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">           </span><br><span class="line"><span class="comment"># -------------------------------------------------------</span></span><br><span class="line"><span class="comment"># shapiro检验</span></span><br><span class="line">library<span class="punctuation">(</span>stats<span class="punctuation">)</span></span><br><span class="line">shapiro.test<span class="punctuation">(</span>x1<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 该检验对样本容量相当敏感，对小样本比较适用</span></span><br></pre></td></tr></table></figure>



<hr>
<h1 id="2025-3-6"><a href="#2025-3-6" class="headerlink" title="2025-3-6"></a>2025-3-6</h1><h2 id="重要概念"><a href="#重要概念" class="headerlink" title="重要概念"></a>重要概念</h2><h2 id="思考题"><a href="#思考题" class="headerlink" title="思考题"></a>思考题</h2><p>1、在一元正态QQ图中，$x(j)与q(j)之间的关系，也就是q(j)和N(\mu,\sigma^2)之间的关系$</p>
<p><a href="/../source/img/image-20250306140818225.png" title="image-20250306140818225" class="gallery-item" style="box-shadow: none;"> <img src="/../source/img/image-20250306140818225.png" alt="image-20250306140818225"></a><br>$$<br>q(j)是N(0,1)的分位数，x(j)是N(\mu,\sigma^2)的分位数.\<br>$$<br>$$<br>我们合理猜测：q(j)&#x3D;ax(j)+b\<br>$$</p>
<p>$$<br>\frac{x(j)-\mu}{\sigma}<br>\approx q(j)\<br>$$</p>
<h2 id="代码摘录"><a href="#代码摘录" class="headerlink" title="代码摘录"></a>代码摘录</h2><hr>
<h1 id="2025-3-9"><a href="#2025-3-9" class="headerlink" title="2025-3-9"></a>2025-3-9</h1><h2 id="一、重要概念-2"><a href="#一、重要概念-2" class="headerlink" title="一、重要概念"></a>一、重要概念</h2><h3 id="主成分分析"><a href="#主成分分析" class="headerlink" title="主成分分析"></a>主成分分析</h3><p>主成分的思想：找少数新的互不相关的变量，用其替代原来大的变量，并解释其变异。是特定的线性组合（原始变量的线性组合）</p>
<p>至于这个变异，今天看一本书看到关于它的有趣的定义：<br>变异所代表的意思是同样的物件或事情，当它一再重复发生的是哦胡，不论我们如何用心测量，总是不能得到同样的结果。如生产线上的规格，绝不可能100%的合格。【来自《生活中的统计学》第一篇：万物有常，世事多变。中国统计杂志社】</p>
<p>在这篇文章中还有一句有趣的话：是五台山显通寺大文殊殿的一副对联</p>
<p>法身无去无来住寂光而不动，德相非空非有应随机以恒周。</p>
<p>2、主成分分析模型德表达形式与推导</p>
<p>3、PCA求解用到条件极值，一般使用拉格朗日乘子法</p>
<p>4、多元函数，梯度问题相关</p>
<p>5、任何一个协方差阵都是非负定阵</p>
<p>6、实对称矩阵中不同特征值对应德特征向量正交；在统计上便是不想关；<br>但是如果有重根，施密特正交化可以保证找到两个正交的向量</p>
<p>7、基于协方差阵和基于相关系数矩阵求解主成分的区别；<br>使用相关系数矩阵提取主成分：$tr(R)&#x3D;p$。</p>
<p>8、主成分得分：PC scores是从样本出发得到的</p>
<h2 id="二、思考题-2"><a href="#二、思考题-2" class="headerlink" title="二、思考题"></a>二、思考题</h2><p>1、主成分求解那里，使用language乘子法，有一个多元函数偏导问题：<br><span><br>$$<br>PCA求解\<br>max ~~{\alpha_1}^T\Sigma{\alpha_1}~~~~s.t.||{\alpha_1||&#x3D;1}\<br>满足：{\alpha}^T\alpha&#x3D;1\<br>language乘子法\<br>f(\alpha_1,\lambda)&#x3D;{\alpha_1}^T\Sigma{\alpha_1}+\lambda({\alpha}^T\alpha-1)\</p>
<p>\begin{cases}<br>\frac{\partial f}{\partial \alpha_1} &#x3D; 0 \<br>\frac{\partial f}{\partial \lambda} &#x3D; 0<br>\end{cases}<br>\Rightarrow \text{?}<br>$$</p>
</span>

<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/273729929">矩阵求导公式的数学推导（矩阵求导——基础篇） - 知乎 (zhihu.com)</a></p>
<p>【矩阵求导——标量函数的偏导数矩阵】<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV13V4y1U7qM?vd_source=8838e67ae5978eeac0d52ce6bfdfdbee">https://www.bilibili.com/video/BV13V4y1U7qM?vd_source=8838e67ae5978eeac0d52ce6bfdfdbee</a></p>
<p><a href="/../source/img/image-20250312234725647.png" title="image-20250312234725647" class="gallery-item" style="box-shadow: none;"> <img src="/../source/img/image-20250312234725647.png" alt="image-20250312234725647"></a></p>
<p><a href="/../source/img/image-20250312234812164.png" title="image-20250312234812164" class="gallery-item" style="box-shadow: none;"> <img src="/../source/img/image-20250312234812164.png" alt="image-20250312234812164"></a></p>
<p>如此即可求得结果，周日记得补充该笔记公式</p>
<p>2、<br>$$<br>\rho_{Y_1,X_2} &#x3D; \frac{e_{12} \sqrt{\lambda_1}}{\sqrt{\sigma_{22}}}是怎么推来的，可以使用R<br>$$<br>方法建议：硬推或者转为矩阵代数</p>
<h3 id="推导过程"><a href="#推导过程" class="headerlink" title="推导过程"></a>推导过程</h3><span>
$$
假设我们有一个变量 ( X_2 ) 和一个主成分 ( Y_1 )，\\我们想要计算它们之间的相关系数 ( \rho_{Y_1,X_2} )。
$$
</span>

<ol>
<li><p><strong>定义相关系数</strong>：</p>
<span>
$$
相关系数的定义是两个变量的协方差除以它们的标准差的乘积：\\
\rho_{Y_1,X_2} = \frac{\text{Cov}(Y_1, X_2)}{\sigma_{Y_1} \sigma_{X_2}}\\
其中，(\text{Cov}(Y_1, X_2)) 是 ( Y_1 ) 和 ( X_2 ) 的协方差\\，(\sigma_{Y_1}) 和 (\sigma_{X_2}) 分别是 ( Y_1 ) 和 ( X_2) 的标准差。
$$
</span>
</li>
<li><p><strong>主成分分析（PCA）背景</strong>：</p>
<span>
$$
在 PCA 中，主成分 ( Y_1 ) 是原始变量的线性组合，通常表示为：\\
Y_1 = e_{11} X_1 + e_{12} X_2 + \cdots + e_{1p} X_p
\\
其中，( e_{1j} ) 是载荷矩阵中的元素，\\表示主成分 ( Y_1 ) 和原始变量 ( X_j ) 之间的线性关系系数。
$$
</span>
</li>
<li><p><strong>协方差计算</strong>：</p>
<span>
$$
假设 ( Y_1 ) 和( X_2 ) 的协方差为：\\

<p>\text{Cov}(Y_1, X_2) &#x3D; e_{12} \lambda_1\</p>
<p>Y_1 &#x3D; e1^TX\</p>
<p>其中， \lambda_1 是第一个主成分的方差贡献率，或者是某个特征值。<br>$$</p>
</span>
</li>
<li><p><strong>标准差计算</strong>：</p>
<span>
$$
Y_1 的方差为  \lambda_1，因此其标准差为 \sqrt{\lambda_1} 。\\

<p> X_2  的方差为 \sigma_{22} ，因此其标准差为 \sqrt{\sigma_{22}}<br>$$</p>
</span>
</li>
<li><p><strong>代入相关系数公式</strong>：</p>
<span>
$$
1. 将协方差和标准差代入相关系数公式：\\
\
   \rho_{Y_1,X_2} = \frac{e_{12} \lambda_1}{\sqrt{\lambda_1} \sqrt{\sigma_{22}}} = \frac{e_{12} \sqrt{\lambda_1}}{\sqrt{\sigma_{22}}}
$$
</span></li>
</ol>
<p>这里有问题，尚待解决</p>
<h2 id="三、代码摘录-1"><a href="#三、代码摘录-1" class="headerlink" title="三、代码摘录"></a>三、代码摘录</h2></div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2025-02-21</span>
            
                <span>该篇文章被 刘晓亮</span>
            
            
                <span>打上标签:
                    
                    
                        <a href='/tags/%E5%A4%9A%E5%85%83%E7%BB%9F%E8%AE%A1/'>
                            多元统计
                        </a>
                    
                </span>
             
             
                <span>归为分类:
                    
                    
                        <a href='/categories/%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1/'>
                            数理统计
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                
                    <span>上一篇：<a href='/2025/02/21/%E9%9A%8F%E7%AC%94/'>历史反思</a></span>
                

                
                    <span class="post-footer-pre-next-last-span-right">下一篇：<a href="/2025/02/19/%E8%8B%B1%E8%AF%AD%E5%8F%A5%E5%AD%90%E6%91%98%E6%8A%84/">英语句子摘抄</a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            © 1949-2025 China 

            
                

            
                
                    / <a href="/friends/"> 友链 </a>
                

            
                
                    / <a href="/contact/"> 联系 </a>
                

            
                
                    / <a href="/support/"> 支持 </a>
                

            
        </span>
       
    
</div>



<!--这是指一条线往下的内容-->
<div class="footer-last">
    
            <span>🌊看过大海的人不会忘记海的广阔🌊</span>
            
                <span class="footer-last-span-right"><i>本站由<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>驱动｜使用<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>主题</i></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--目录-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--回到顶部按钮-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // 启用插件
            thumbnail: true,          // 显示缩略图
            zoom: true,               // 启用缩放功
            rotate: true,             // 启用旋转功能能
            autoplay: true,        // 启用自动播放功能
            fullScreen: true,      // 启用全屏功能
            pager: false, //页码,
            zoomFromOrigin: true,   // 从原始位置缩放
            actualSize: true,       // 启用查看实际大小的功能
            enableZoomAfter: 300,    // 延迟缩放，确保图片加载完成后可缩放
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // 修复选择器
    }
    
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 

                </div>
            
            
                <!-- 回到顶部的按钮-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- 返回的按钮-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>